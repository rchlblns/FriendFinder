<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!--Import Google Icon Font-->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <!--jQuery  -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>

    <title>Survey</title>
</head>

<body>
    <div class="container">
        <div class="row center-align">
            <h1>Tell Us About Yourself</h1>
            <div class="col s12">
                <div class="input-field col s12">
                    <input id="name" type="text" class="validate">
                    <label for="name">Your Name</label>
                </div>
                <div class="input-field col s12">
                    <input id="photo" type="text" class="validate">
                    <label for="name">Picture of You</label>
                </div>
            </div>
        </div>

        <div class="divider"></div>

        <div class="row center-align">
            <div class="input-field col s6 offset-s3" id="q1">
                <h5>I believe in the importance of art and music.</h5>
                <select class="browser-default">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1 - Strongly Disagree</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="3">4</option>
                    <option value="3">5 - Strongly Agree</option>
                </select>
            </div>
            <div class="input-field col s6 offset-s3" id="q2">
                <h5>I enjoy being spontaneous and unpredictable.</h5>
                <select class="browser-default">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1 - Strongly Disagree</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="3">4</option>
                    <option value="3">5 - Strongly Agree</option>
                </select>
            </div>
            <div class="input-field col s6 offset-s3" id="q3">
                <h5>I consider myself more of a listener than a talker.</h5>
                <select class="browser-default">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1 - Strongly Disagree</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="3">4</option>
                    <option value="3">5 - Strongly Agree</option>
                </select>
            </div>
            <div class="input-field col s6 offset-s3" id="q4">
                <h5>I'd rather make a lot of money than have a job that makes me happy.</h5>
                <select class="browser-default">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1 - Strongly Disagree</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="3">4</option>
                    <option value="3">5 - Strongly Agree</option>
                </select>
            </div>
            <div class="input-field col s6 offset-s3" id="q5">
                <h5>It's more important to be honest than kind.</h5>
                <select class="browser-default">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1 - Strongly Disagree</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="3">4</option>
                    <option value="3">5 - Strongly Agree</option>
                </select>
            </div>
            <div class="input-field col s6 offset-s3" id="q6">
                <h5>My home and work environments are quite tidy.</h5>
                <select class="browser-default">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1 - Strongly Disagree</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="3">4</option>
                    <option value="3">5 - Strongly Agree</option>
                </select>
            </div>
            <div class="input-field col s6 offset-s3" id="q7">
                <h5>I find it easy to stay relaxed even when there is some pressure.</h5>
                <select class="browser-default">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1 - Strongly Disagree</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="3">4</option>
                    <option value="3">5 - Strongly Agree</option>
                </select>
            </div>
            <div class="input-field col s6 offset-s3" id="q8">
                <h5>I do not let other people influence my actions.</h5>
                <select class="browser-default">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1 - Strongly Disagree</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="3">4</option>
                    <option value="3">5 - Strongly Agree</option>
                </select>
            </div>
            <div class="input-field col s6 offset-s3" id="q9">
                <h5>Heart is more important than logic when making important decisions.</h5>
                <select class="browser-default">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1 - Strongly Disagree</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="3">4</option>
                    <option value="3">5 - Strongly Agree</option>
                </select>
            </div>
            <div class="input-field col s6 offset-s3" id="q10">
                <h5>I don't like to draw attention to myself.</h5>
                <select class="browser-default">
                    <option value="" disabled selected>Choose your option</option>
                    <option value="1">1 - Strongly Disagree</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="3">4</option>
                    <option value="3">5 - Strongly Agree</option>
                </select>
            </div>
        </div>

        <div class="container center-align">
            <button class="btn-large waves-effect waves-light hoverable align-right modal-trigger" id="submitBtn"
                type="submit" href="#resultsModal">Submit
            </button>
        </div>
    </div>

    <!-- Modal -->
    <div id="resultsModal" class="modal">
        <div class="modal-content center-align">
            <h4>Your New Best Friend</h4>
            <h5 class="matchName"></h5>
            <img id="matchPic" src="" alt="" style="max-width: 500px;">
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
        </div>
    </div>



    <script type="text/javascript">

        $(document).ready(function () {   

            $("#submitBtn").on("click", function() {

                $('select').formSelect();
                $(".modal").modal();

                //form validation
                function validateForm() {

                    let isValid = true;
                    
                    //if text input is empty
                    $(".validate").each(function() {
                        if ($(this).val() === "") {
                        isValid = false;
                        }
                    });
                    
                    //if there are unanswered questions
                    $(".browser-default").each(function () {
                        if ($(this).val() === "") {
                        isValid = false;
                        }
                    });

                    return isValid;
                }
                
                validateForm();

                //if all form areas are filled out
                if (validateForm() === true) {

                    //captures submitted values
                    let newFriendData = {
                        name: $("#name").val().trim(),
                        photo: $("#photo").val().trim(),
                        scores: [
                            $("#q1").val(),
                            $("#q2").val(),
                            $("#q3").val(),
                            $("#q4").val(),
                            $("#q5").val(),
                            $("#q6").val(),
                            $("#q7").val(),
                            $("#q8").val(),
                            $("#q9").val(),
                            $("#q10").val()
                        ]
                    };
                    
                    //grabs current URL of website
                    let currentURL = window.location.orgin;

                    //posts user data to the friends API
                    $.post(currentURL + "/api/friends", newFriendData, function(data) {

                        $("#matchName").text(data.name);
                        $("#matchPic").attr("src", data.profilePic);
                    
                    });

                    // opens modal with results
                    $(".modal").open();    
                    
                    //clears form after submission
                    // $("#name").val("");
                    // $("#photo").val("");
                    // $("#q1").val("");
                    // $("#q2").val("");
                    // $("#q3").val("");
                    // $("#q4").val("");
                    // $("#q5").val("");
                    // $("#q6").val("");
                    // $("#q7").val("");
                    // $("#q8").val("");
                    // $("#q9").val("");
                    // $("#q10").val("");

                } else {
                    //displays alert 
                    M.toast({html: "Please fill out all fields before submitting.", classes: "rounded"});
                }

                return false;
            });

        });


    </script>

</body>

</html>